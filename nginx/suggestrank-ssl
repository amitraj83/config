server {

       listen 443 ssl;
       listen [::]:443 ssl;

       server_name suggestrank.com;

       ssl_certificate   /etc/letsencrypt/live/suggestrank.com/fullchain.pem;
       ssl_certificate_key   /etc/letsencrypt/live/suggestrank.com/privkey.pem;
       ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;

       root /var/www/suggestrank/wp/;
       index index.html;

        location / {
        proxy_pass http://localhost:81;
        }
        location /api {
        proxy_pass http://localhost:5000;
        }



	location  ~ ^/blog(/.*)?$ {
	        root /var/www/suggestrank/wp/;
		try_files $uri $uri/ /blog/index.php?$query_string;
       		index index.php index.html;


		location ~  /.*\.php$ {
     	   		include /etc/nginx/snippets/fastcgi-php.conf;
        		fastcgi_pass unix:/var/run/php/php7.4-fpm.sock;

                	include fastcgi_params;
		
     		}
	}


    	location ~ /\.ht {
        	deny all;
    	}
}


server {
    listen 80 default_server;

    server_name _;

    return 301 https://$host$request_uri;
}
